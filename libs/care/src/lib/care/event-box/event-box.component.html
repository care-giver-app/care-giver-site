<div class="event-box">
    <div class="card">
        <h5 class="card-header"
            [ngStyle]="{ 'background': eventMetaData.color.secondary, 'color': eventMetaData.color.primary }">
            {{eventMetaData.type}}</h5>
        <div class="card-body">
            @if (latestEvent){
            <h5 class="card-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clock"
                    viewBox="0 0 16 16">
                    <path d="M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71z" />
                    <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0" />
                </svg>
                {{ eventTimestamp }}
            </h5>
            <p class="card-text">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pen"
                    viewBox="0 0 16 16">
                    <path
                        d="m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001m-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708z" />
                </svg>
                {{ loggedUser }}
            </p>
            <p *ngIf="eventMetaData.dataName"><strong>Data:</strong> {{ latestEvent.data?.[0]?.value }}</p>
            }
            @else {
            <h5 class="card-title">No Events Logged Yet</h5>
            }
            <div class="container text-center">
                <div class="row align-items-start">
                    <div class="col">
                        <button class="btn btn-primary" (click)="onLogEvent()">Log Now</button>
                    </div>
                    <div class="col">
                        <button class="btn btn-primary" (click)="onLogEventWithTime()">Input Time</button>
                    </div>
                </div>
                <div class="row align-items-start">
                    <div class="col">
                        <button class="btn btn-danger" (click)="onDeleteEvent(latestEvent?.eventId || '')">Delete Latest
                            Event </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<care-modal [show]="showModal" [header]="'Add ' + eventMetaData.type" (close)="closeModal()">
    <div modal-body>
        <label for="timestampInput">Timestamp</label>
        <input id="timestampInput" [(ngModel)]="eventTimestampInput" type="datetime-local" class="form-control" />

        @if (eventMetaData.dataName) {
        <label for="dataInput">{{ eventMetaData.dataName }}</label>
        <input id="dataInput" [(ngModel)]="inputValue" type="number" placeholder="Enter {{ eventMetaData.dataName }}"
            class="form-control" />
        }
    </div>
    <div modal-footer>
        <button class="btn btn-primary modal-button" (click)="submitEvent()">Add Event</button>
        <button class="btn btn-secondary modal-button" (click)="closeModal()">Cancel</button>
    </div>
</care-modal>

<!-- Modal -->
<!-- <div class="modal" *ngIf="showModal" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
        <h3>Add {{ eventMetaData.type }}</h3>

        <label for="timestampInput">Timestamp</label>
        <input id="timestampInput" [(ngModel)]="eventTimestampInput" type="datetime-local" value="" />

        @if (eventMetaData.dataName) {
        <label for="dataInput">{{ eventMetaData.dataName }}</label>
        <input id="dataInput" [(ngModel)]="inputValue" type="number" placeholder="Enter {{ eventMetaData.dataName }}" />
        }

        <div class="modal-actions">
            <button class="modal-button" (click)="submitEvent()">Submit</button>
            <button class="modal-button cancel" (click)="closeModal()">Cancel</button>
        </div>
    </div>
</div> -->